@using EcommereceWeb.Application.Interfaces.Common;

@inject IServiceManager serviceManager
@{
    var res =await  serviceManager.AttributeService.GetAll();

}
<form asp-controller="Attribute" asp-action="Create" method="post">

    <div class="form-group mb-50">
        <label class="text-bold-600" for="exampleInputEmail1">صفات المنتج </label>

        <select class="form-select" id="Att">
            @if (res.Status.Succeeded)
            {
                foreach(var item in res.Data)
                {
                    <option value="@item.Id">@item.ArName</option>

                }
            }
        </select>
    </div>

     <div class="form-group mb-50">
        <label class="text-bold-600" for="exampleInputEmail1"> عناصر الصفات </label>

        <select class="form-select"   id="AttItem"  >
           <option>..........</option>      
        </select>
    </div>

    <ul  id="pp"></ul>

    <div class="modal-footer d-inline-flex">
        <a class="btn btn-secondary" asp-action="Index">Cancel</a>
        <input type="submit"  class="btn alert-info" value="Add Attribute">
    </div>
</form>
@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
        <script>
    $("#Att").on("change", function () {
        console.log("hhhhhhhhhhhhhhhhhhhh");
        let id=$(this).val();
        let url = "../ProductAttribute/getAttrItems";
        let item = "";
        jQuery.ajax({
            method: "get",
            url: url,
            data: { "id": id },
            contentType: false,
            success: function (res) {
                res.map(a => {
                    item += `<option selected value="${a.id}"> ${a.name}</option>`;
                });
                $("#AttItem").html(item);


            },
            error:function(ex){
                alert("errrrrrrrrrr  " + ex.responseText);
            }
        });
    });
      
        /////////////// 
         let list = [];

      
    $("#AttItem").on("change",function(){
           if(list.length===0){
                list.push({ "id": $(this).val(), "name": $('#AttItem option:selected').text() });
           
           }else{
                if (list.some(a=>a.id==$(this).val()) ) {
                    console.log("gggggggggg");
                   
                }
                else {
                    list.push({ "id": $(this).val(), "name": $('#AttItem option:selected').text() });
                    
                   
                   
                }
            }


           
          
         
            

    });
        list.map(p => {


            $("#pp").append(`<li class="btn btn-secondary">${p.name}</li>`);

        })
    //function remove(data){
    //    //$("#pp li:eq(\"data\")").remove();
    //      //console.log("eeeeeeeeee  " + data.name);
    //       list=list.filter(function(item){
    //           console.log("item "+item.name);
    //            return item !== data;
    //        });
           
    //}
        </script>}